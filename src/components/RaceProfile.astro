---
import { formatLineBreaks } from "../utils/textUtils";

const {
  kontrollmalt = true,
  kontrolltekst = "L√∏ypen er kontrollm√•lt av Norsk Friidrett ‚Äì april 2022",
  kontrollbilde = "/KontrollertLoype.png",
  tittel = "üìç L√∏ypeprofil",
  beskrivelse1 = "Helmaratonl√∏ypa (halvmaraton x 2) har start og m√•l p√• Nordhus Stadion. Den g√•r i naturskj√∏nne omgivelser langs Torg√∏yene og rundt det sagnomsuste fjellet Torghatten.",
  beskrivelse2 = "L√∏ypen er noks√• flat. Starter ca 8 moh, h√∏yeste punkt 32 moh etter 12,5 km. Jevn stigning og lett nedover til m√•l.",
  profileId = "race-profile", // Ny prop for unik ID
} = Astro.props;

// Generer unik ID hvis ikke gitt
const headingId = `${profileId}-heading`;
---

<section
  class="bg-white/90 text-black py-16 px-6 backdrop-blur-sm"
  aria-labelledby={headingId}
  role="region"
>
  <div class="max-w-6xl mx-auto">
    <!-- Hovedinnhold - full bredde -->
    <div class="mb-8">
      <h2
        id={headingId}
        class="text-2xl md:text-3xl font-bold mb-4 text-gray-900"
      >
        {tittel}
      </h2>

      <div class="space-y-4">
        <p class="text-base md:text-lg leading-relaxed text-gray-900">
          {beskrivelse1}
        </p>

        <div
          class="bg-blue-50 border-l-4 border-blue-300 p-4 rounded-r-lg"
          role="complementary"
          aria-label="Tekniske detaljer om l√∏ypa"
        >
          <p
            class="text-sm md:text-base text-gray-800 leading-relaxed"
            set:html={formatLineBreaks(beskrivelse2)}
          />
        </div>
      </div>
    </div>

    <!-- Kontrollm√•l seksjon - under beskrivelsen -->
    {
      kontrollmalt && (
        <div class="flex flex-col items-center justify-center py-6 border-t border-gray-200">
          <a
            href="https://www.friidrett.no/"
            target="_blank"
            rel="noopener noreferrer"
            class="group block text-center hover:scale-105 transition-transform duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded-lg"
            aria-label="Bes√∏k Norges Friidrettsforbund - √•pnes i ny fane"
          >
            <img
              src={kontrollbilde}
              alt="Offisielt godkjent l√∏ype - kontrollm√•lt av Norsk Friidrett"
              class="w-40 md:w-48 mx-auto mb-3 rounded-full opacity-80 shadow-lg group-hover:opacity-100 transition-opacity duration-200"
              loading="lazy"
              role="img"
            />
            <p class="text-sm text-gray-800 font-medium group-hover:text-blue-600 transition-colors">
              {kontrolltekst}
            </p>
            <p class="text-xs text-gray-600 mt-1 group-hover:text-blue-500 italic">
              Klikk for √• bes√∏ke Norges Friidrettsforbund ‚Üó
            </p>
          </a>
        </div>
      )
    }
  </div>
</section>
